import React from 'react';
import { useDroppable } from '@dnd-kit/core';
import { DocumentInfo } from '../lib/tauri-api';
import { DraggableDocumentCard } from './DraggableDocumentCard';
import { useTheme } from '../contexts/ThemeContext';

export interface KanbanColumnProps {
  title: string;
  phase: string;
  documents: DocumentInfo[];
  onDocumentClick?: (document: DocumentInfo) => void;
  emptyMessage?: string;
  isDragging?: boolean;
}

export const KanbanColumn: React.FC<KanbanColumnProps> = ({
  title,
  phase,
  documents,
  onDocumentClick,
  isDragging = false,
}) => {
  const { theme } = useTheme();
  const { isOver, setNodeRef } = useDroppable({
    id: phase,
  });

  const getPhaseStyle = () => {
    return {
      backgroundColor: isOver ? theme.colors.interactive.secondary : theme.colors.background.secondary,
      borderColor: isOver ? theme.colors.interactive.primary : theme.colors.border.primary,
    };
  };

  const phaseStyle = getPhaseStyle();

  return (
    <div 
      ref={setNodeRef}
      className={`flex flex-col h-full min-h-96 rounded-lg border-2 transition-all duration-200 ${
        isOver ? 'scale-105' : ''
      }`}
      style={{
        backgroundColor: phaseStyle.backgroundColor,
        borderColor: phaseStyle.borderColor,
        opacity: isDragging && !isOver ? 0.7 : 1,
      }}
    >
      {/* Column Header */}
      <div 
        className="p-4 border-b"
        style={{ borderColor: theme.colors.border.primary }}
      >
        <h3 
          className="font-semibold text-lg text-center"
          style={{ color: theme.colors.text.primary }}
        >
          {title}
        </h3>
      </div>

      {/* Column Content */}
      <div className="flex-1 p-3 space-y-3 overflow-y-auto">
        {documents.length === 0 ? (
          <div className="h-full" />
        ) : (
          documents.map((doc) => (
            <DraggableDocumentCard
              key={doc.short_code}
              document={doc}
              onClick={onDocumentClick}
            />
          ))
        )}
      </div>
    </div>
  );
};